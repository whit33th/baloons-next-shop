# Ballonique - Обновления сайта

## Выполненные изменения

### 1. Обновлены категории товаров

Категории в каталоге обновлены согласно требованиям:

- **Детские** (мальч/девоч)
- **Для неё**
- **Для него**
- **Кохання**
- **Мама**
- **Рождение ребёнка**
- **Сюрприз в шаре**
- **Юбилей**
- **Букеты из шаров**
- **Для любого события**

Файл: `components/Containers/ProductFilters/ProductFilters.tsx`

### 2. Реализован новый платёжный флоу

#### Добавлены три метода оплаты:

1. **Полная онлайн-оплата (Stripe)**
   - Оплата 100% онлайн
   - Набор бронируется сразу после оплаты
   - Автоматическое уменьшение количества товара на складе

2. **Предоплата 30%**
   - Оплата 30% онлайн для бронирования
   - Остаток оплачивается наличными при самовывозе
   - Набор бронируется после внесения предоплаты

3. **Оплата наличными при самовывозе**
   - Доступна только при выборе самовывоза
   - **Обязательное подтверждение через WhatsApp**
   - Кнопка "Оформить заказ" активируется только после нажатия на кнопку WhatsApp
   - Клиент должен подтвердить дату и время самовывоза

#### Обновленные файлы:

- `convex/schema.ts` - добавлены поля для типа доставки и оплаты
- `convex/orders.ts` - обновлена мутация создания заказа
- `convex/paymentMutations.ts` - добавлена поддержка частичной оплаты
- `app/checkout/page.tsx` - полностью переработанная страница оформления заказа

### 3. Добавлена информация о доставке

Создана новая страница `/delivery` с подробной информацией:

- Адрес самовывоза: Sandgasse 3, 8720 Knittelfeld
- Часы работы: 24/7
- Доставка: 16:00-21:00 (+16€)
- Срок подготовки: 72 часа (3 дня)
- Правила отмены: за 48 часов

Файл: `app/delivery/page.tsx`

## Требуется дополнительная настройка

### 1. WhatsApp номер

Замените `YOUR_WHATSAPP_NUMBER` на реальный номер WhatsApp в следующих файлах:

- `app/checkout/page.tsx` (строка 37)
- `app/delivery/page.tsx` (строка 189)

Формат: без знака + и пробелов, например: `436641234567`

### 2. Иконки категорий

Добавьте иконки в папку `/public/icons/`:

- `kids.png` - Детские
- `for-her.png` - Для неё
- `for-him.png` - Для него
- `love.png` - Кохання
- `mom.png` - Мама
- `baby.png` - Рождение ребёнка
- `surprise.png` - Сюрприз в шаре
- `anniversary.png` - Юбилей
- `bouquet.png` - Букеты из шаров
- `any-event.png` - Для любого события

### 3. Stripe интеграция

Для полноценной работы онлайн-платежей необходимо:

1. Настроить Stripe API ключи в переменных окружения
2. Создать обработчики webhook для Stripe
3. Реализовать создание платёжных намерений (payment intents)

## Структура заказа в базе данных

```typescript
{
  userId: Id<"users">,
  items: Array<{
    productId: Id<"products">,
    productName: string,
    quantity: number,
    price: number
  }>,
  totalAmount: number,
  status: "pending" | "confirmed" | "shipped" | "delivered",
  customerEmail: string,
  customerName: string,
  shippingAddress: string,
  deliveryType: "pickup" | "delivery",
  paymentMethod: "full_online" | "partial_online" | "cash",
  paymentIntentId?: string,
  whatsappConfirmed?: boolean,
  pickupDateTime?: string
}
```

## Запуск проекта

```bash
# Установка зависимостей
pnpm install

# Запуск Convex
pnpm convex dev

# Запуск Next.js
pnpm dev
```

## Примечания

- Готовая функциональность не изменялась
- Все тексты на двух языках: русский и немецкий
- Дизайн соответствует текущему стилю сайта
- Валидация форм на клиенте и сервере
